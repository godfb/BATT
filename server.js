var express = require('express');
var path = require('path');
var bodyParser = require('body-parser');
var data = require("./data.js");
var twilio = require('twilio')(process.env['TwilioKey'], process.env['TwilioSecret']);


//var db = JSON.parse(data);

var app = express();
app.use(bodyParser.json()); // for parsing application/json
app.use(bodyParser.urlencoded({ extended: true }));
app.use('/', express.static(__dirname + '/Client'));
app.set('port', process.env.PORT || 3000);

var server = app.listen(app.get('port'), function() {
    console.log('Server listening on port ' + server.address().port);
});

app.post('/search', function(req, res) {
    if (req.body) {
        req.body.query = req.body.query.toUpperCase();
        var searchString = req.body.query + '" --> "' + db[req.body.query] + '".';
        console.log(searchString);
        console.log(req.body.query);
        var returnObj = {};
        if (req.body.query === ""){
            console.log("made it here");
            returnObj.query = "";
            returnObj.data = [];
            res.send(returnObj);
        }
        else if (!db[req.body.query]){
            var emptyReturn = [];
            emptyReturn[0] = "We don't have that acronym...   : ("
            returnObj.query = "Disaster!";
            returnObj.data = emptyReturn;
            res.send(returnObj);
        }
        else{   
            twilio.sms.messages.create({
                to:'+16602386981',
                    from:process.env['TwilioNumber'],
                body:searchString
                }, 
                function(error, message) {
                    if (!error) {
                        console.log('Success! The SID for this SMS message is:');
                        console.log(message.sid);
                
                        console.log('Message sent on:');
                        console.log(message.dateCreated);
                    } else {
                        console.log('Oops! There was an error.');
                        console.log(error);
                }
            });
            returnObj.query = req.body.query;
            returnObj.data = db[req.body.query];
            res.send(returnObj); 
        }
    }else{
        res.sendStatus(400);
    }
    res.end();
});



var db = JSON.parse('{"BATT":["Better Application Than TAD (BATT)"],"321":["Three2One (321)"],"AAP":[""],"AAUGA":["Autodesk Animation User Group Association (AAUGA)"],"AC":["Autodesk Consulting (AC)"],"ACAD":["AutoCAD (ACAD or ACD)"],"ACD":["AutoCAD (ACAD or ACD)"],"ACE":["Autodesk Certification Evaluator (ACE)"],"ACI":["Autodesk Certified Instructor (ACI)"],"ACRD":["Autodesk China Research and Development (ACRD)"],"AdLM":["Autodesk License Management System (AdLM)"],"ADN":["Autodesk Developer Network (ADN)"],"ADSK":["Autodesk (ADSK)"],"AIM":["Autodesk Infrastructure Modeler (AIM)"],"AISA":["Autodesk Industry Solutions Academy (AISA)"],"AKN":["Autodesk Knowledge Network (AKN)"],"ALC":["Autodesk Learning Central (ALC)"],"ALP":["Autodesk Leadership Program (ALP)"],"AMER":["Americas (AMER)"],"AMPs":["Aligned Marketing Programs (AMPs)"],"ANZ":["Australia and New Zealand (ANZ)"],"AP":["Accounts Payable (AP)"],"APAC":["Asia-Pacific (APAC)"],"AR":["Action Request (AR)"],"ARC":["Average Revenue Class (ARC)"],"ARPV":["Accumulated Reseller Purchase Value (ARPV)"],"ASAP":[""],"ASEAN":["Association of Southeast Asian Nations (ASEAN)"],"ASM":["Autodesk Shape Manager (ASM)"],"ASP":["Average Selling Price (ASP)"],"ASRD":["Autodesk Singapore Research and Development (ASRD)"],"ATC":["Autodesk Authorized Training Center (ATC)"],"ATUBE":[""],"AU":["Autodesk University (AU)"],"AUGI":["Autodesk User Group International (AUGI)"],"AutoCAD DXF":["AutoCAD Drawing Exchange Format (AutoCAD DXF)"],"AWS":["Autodesk Workplace Strategy (AWS)"],"BC":["Business Continuity (BC)"],"BCP":["Business Continuity Planning (BCP)"],"BIA":["Business Impact Analysis (BIA)"],"BIM":["Building Information Modeling (BIM)"],"BOM":["Bill of Material (BOM)"],"BPA":["Business Process Assessment"],"BRIC":["Brazil, Russia, India, and China (BRIC)"],"C13N":["Countrification (C13N)"],"CAGR":["Compound Annual Growth Rate (CAGR)"],"CBC":["Customer Briefing Center (CBC)"],"CBP":["Customer Briefing Program (CBP)"],"CCB":["Change Control Board (CCB)"],"CDC":["Custom Development Center (CDC)"],"CDDP":["Competitive Deal Discount Pricing (CDDP)"],"CDE":[""],"CDF":["Channel Development Funds (CDF)"],"CEP":["Client Engagement Plan (CEP)"],"CER":["Customer Error Reporting (CER)"],"CES":["Customer Effort Score (CES)"],"CFD":["Computational Fluid Dynamics (CFD)"],"CFERT":["Configurable FERT (CFERT)"],"CHS":["Czech Republic, Hungary, and Southeastern Europe (CHS)"],"CIM":["Computer-Integrated Manufacturing (CIM)"],"CIP":["Customer Involvement Program (CIP)"],"CIS":["Commonwealth of Independent States (CIS)"],"CLic":["Cloud Licensing (CLic)"],"CM":["Subscription Contract Manager (CM)"],"CMT":["Crisis Management Team (CMT)"],"COBC":["Code of Business Conduct (COBC)"],"COGS":["Cost of Goods Sold (COGS)"],"CQS":["Contract Quantity Scale (CQS)"],"CR":["Community Relations (CR)"],"CRB":["Channel Review Board (CRB)"],"CRD":["Customer Requirement Document (CRD)"],"CRE":["Corporate Real Estate (CRE)"],"CREFTS":["Corporate Real Estate, Facilities, Travel, Safety, and Security (CREFTS)"],"CRM":["Customer Relationship Management (CRM)"],"CSC":["Channel Sales Capacity (CSC)"],"CSI":["Consulting System Integrator Partner Program (CSI)"],"CSM":["Customer Success Manager (CSM)"],"CSN":[""],"CSS":["Customer Service and Support (CSS)"],"CV":["Customer Value (CV)"],"CX":["Customer Experience (CX)"],"CXD":["Customer Experience Design (CXD)"],"CY":["Calendar Year (CY)"],"D&B":[""],"DACH":["Deutschland, Austria, Switzerland (Confoederatio Helvetica) (DACH)"],"DAM":["Digital Asset Management (DAM)"],"DDA":["Deal Discount Approval (DDA)"],"DEC":["Digital Entertainment Creation (DEC)"],"DERL":[""],"DevTech":["Developer Technical Services (DevTech)"],"DID":["Defect ID (DID)"],"DISO":["Departmental Individual Standing Offer (DISO)"],"DLS":["Design, Lifecycle, and Simulation (DLS)"],"DMR":["Direct Marketing Reseller (DMR)"],"DR":["Disaster Recovery (DR)"],"DSS":["Designated Support Specialist"],"DTS":[""],"DUNS":[""],"DUPA":[""],"DVAR":["Direct Value-Added Reseller (DVAR)"],"e-Flex":["Enterprise Flex Offering (e-Flex)"],"EAI":["Enterprise Application Integration (EAI)"],"EB":["Partner Earnbacks (EB)"],"EBA":["Enterprise Business Agreement (EBA)"],"ECCN":["Export Control Classification Number (ECCN)"],"ECO":["Engineering Change Order (ECO)"],"EDM":["Engineering Data Management (EDM)"],"EDU":["Education (EDU)"],"EHP":[""],"EidM":["Enterprise Identity Management (EidM)"],"EIS":["Enterprise Information Services (EIS)"],"ELP":["Employee Leadership Program (ELP)"],"EMEA":["Europe, Middle East, and Africa (EMEA)"],"EMIA":["Europe, Middle East, India, and Africa (EMIA)"],"ENI":["Engineering, Natural Resources, and Infrastructure (ENI)"],"ENT":["Enterprise"],"EOC":["Enterprise Operations Center (EOC)"],"EOM":["End of Month (EOM)"],"EOQ":["End of Quarter (EOQ)"],"ERM":["Enterprise Risk Management (ERM)"],"ERP":["Employee Referral Program (ERP)"],"ERT":["Emergency Response Team (ERT)"],"ESD":["Electronic Software Download (ESD)"],"ESSO":["Enterprise Single Sign-On (ESSO)"],"ETR":["Employee Training Registration (ETR)"],"EUE":["End-User Expenditure (EUE)"],"FBP":["Finance Business Partner (FBP)"],"FCS":["First Customer Shipment (FCS)"],"FDM":[""],"FIRST":["For Inspiration and Recognition of Science and Technology (FIRST)"],"FoMT":[""],"FPA":["Financial Planning and Analysis (FPA)"],"FPS":["Finance Processes and Systems (FPS)"],"FQ":["Fiscal Quarter (FQ)"],"FRED":["Future Requirements Enterprise Document (FRED)"],"FRT":["Functional Recovery Team (FRT)"],"FTE":["Full-Time Equivalent (FTE)"],"FTR":["First Touch Resolution (FTR)"],"FY":["Fiscal Year (FY)"],"GA":["Global Account (GA)"],"GBS":["Global Business Services (GBS)"],"GCSO":["Global Customer Support and Operations (GCSO)"],"GE":["Global Engineering (GE)"],"GET":[""],"GI":["Global Initiative (GI)"],"GL":["General Ledger (GL)"],"GLOB":["Globalization (GLOB)"],"GNUL":["Global Network User License (GNUL)"],"GoalPOST":[""],"GRP":["Global Reference Price (GRP)"],"GS":["Global Services (GS)"],"GSO":["Global Sales Operations (GSO)"],"GSOST":["Global Subscription Operations and Services Team (GSOST)"],"GST":["Goods and Services Tax (GST)"],"GUID":["Globally Unique Identifier (GUID)"],"HD":[""],"HR":["Human Resources (HR)"],"HRBP":[""],"HRIS":["Human Resources Information Services (HRIS)"],"i18N":["Internationalization (i18N)"],"IAP":["Individual Accountability Program (IAP)"],"IDEA":["Innovators in Design, Engineering, and Art (IDEA)"],"ILT":[""],"ICE":["International Customer Experience (ICE)"],"IORD":["Internet Order (IORD)"],"IPD":["Integrated Project Delivery (IPD)"],"IPG":["Information Modeling and Platform Products Group (IPG)"],"IPM":["In-Product Marketing (IPM)"],"ISM":["Industry, Strategy, and Marketing (ISM)"],"ISV":["Independent Software Vendor (ISV)"],"ITM":["In-Trial Marketing (ITM)"],"IVAR":["Indirect Value-Added Reseller (IVAR)"],"KSO":["Key Strategic Objective (KSO)"],"LMV":["Large Model Viewing (LMV)"],"LC":["Letter of Credit (LC)"],"LEAP":[""],"LI":["Local Initiative (LI)"],"LSA":["License and Services Agreement (LSA)"],"LSP":["Logistics Service Provider (LSP)"],"LVA":["Low-Value Asset (LVA)"],"M&E":["Media and Entertainment Product Group (M&E)"],"MALT":["Major Account Leadership Team (MALT)"],"MandA":["Mergers and Acquisitions (MandA)"],"MDF":["Marketing Development Funds (MDF)"],"MDM":[""],"MEP":["Mechanical, Electrical, and Plumbing (MEP)"],"MGS":["Marketing Guidelines Site (MGS)"],"MIDM":["Market Intelligence Datamart (MIDM)"],"MIM":["Marketing Investment Management (MIM)"],"MJA":["Major Account (MJA)"],"MLD":["Multi-Language Deployment (MLD)"],"MPG":["Material Pricing Group (MPG)"],"MRU":["Minimum Releasable Unit (MRU)"],"MSA":[""],"NDA":["Non-Disclosure Agreement (NDA)"],"NEO":["New Employee Orientation (NEO)"],"NFC":["National Fulfillment Center Partners (NFC)"],"NFR":["Not For Resale (NFR)"],"NLM":["Network License Manager (NLM)"],"NPS":["Net Promoter Score (NPS)"],"OEM":["Original Equipment Manufacturer (OEM)"],"ORD":["Original Requirements Document (ORD)"],"ORT":["Offering Readiness Team (ORT)"],"OTC":["One Team Conference (OTC)"],"OTE":["On-Target Earnings (OTE)"],"PAC":["Production Assurance Credit"],"PC":["Partner Center (PC)"],"PCX":["Partner Customer Experience (PCX)"],"PI":["Portfolio Item (PI)"],"PIG":["Parent Industry Group (PIG)"],"PII":[""],"PIM":["Parent Industry Mix (PIM)"],"PIS":["Parent Industry Segment (PIS)"],"PLM":["Product Lifecycle Management (PLM)"],"PO":["Purchase Order (PO)"],"POSD":["Point of Sale Data (POSD)"],"PP":[""],"PPC":["Pricing and Packaging Committee (PPC)"],"PPS":["Partner and Product Services (PPS)"],"PPV":["Purchase Price Variance (PPV)"],"PR":["Public Relations (PR)"],"PRM":["Partner Relationship Management (PRM)"],"PSEB":["Platform Solutions and Emerging Business (PSEB)"],"PSO":[""],"PSR":["Physical Shipment Request (PSR)"],"PTP":["Procure to Pay (PTP)"],"Q2C":["Quote to Collect (Q2C)"],"QMR":["Quarterly Marketing Release (QMR)"],"QTP":[""],"RC":["Revenue Class (RC)"],"RCE":["Reputation, Consumer, and Education (RCE)"],"RFP":[""],"ROE":["Return On Equity (ROE)"],"ROI":["Return On Investment (ROI)"],"RTL":["Release to Localization"],"RTM":["Release to Manufacturing (RTM)"],"RTO":["Recovery Time Objective (RTO)"],"RTP":["Release to Print (RTP)"],"RTW":["Release to Web (RTW)"],"SA":["Sales Agent (SA)"],"SAM":["Support Account Manager"],"SC":["Software Coordinator (SC)"],"SCAR":["Supplier Corrective Action Request (SCAR)"],"SCF":["Subscription Customer Fulfillment (SCF)"],"SCL":[""],"SCO":[""],"SDF":["Sales Development Funds (SDF)"],"SEED":[""],"SIC":[""],"SIP":["Solution Incentive Program (SIP)"],"SKU":["Stock-Keeping Unit (SKU)"],"SKU School":["Stock-Keeping Unit School (SKU School)"],"SLM":["Standalone License Manager (SLM)"],"SMB":["Small & Medium Business (SMB)"],"SN":["Serial Number (SN)"],"SOx":["Sarbanes-Oxley Act (SOx)"],"SPR":["Software Provider Revenue (SPR)"],"SPS":["Software as a Service (SaaS) Platform Services"],"SR":["Service Request (SR)"],"SRP":["Suggested Retail Price (SRP)"],"STK":["Sales Toolkit (STK)"],"TAM":["Total Addressed Market (TAM)"],"TAS":["Target Account Selling (TAS)"],"TCE":["Total Customer Experience (TCE)"],"Tflex":["Token Flex Offering"],"TLA":[""],"TOL":["Transfer of License (TOL)"],"TSE":["Territory Sales Executive"],"TTC":["Total Target Compensation (TTC)"],"TTS":["Target and Territory Sheet (TTS)"],"UAU":["Unique Active Users (UAU)"],"UUID":[""],"UXD":["User Experience Design (UXD)"],"VAD":["Value-Added Distributor (VAD)"],"VAR":["Value-Added Reseller (VAR)"],"VAT":["Value-Added Tax (VAT)"],"VC":["Value Class (VC)"],"VCP":["Volume Channel Partner (VCP)"],"VCT":[""],"VIR":["Volume Incentive Rebate (VIR)"],"VRG":["Volume Rebate Group (VRG)"],"VSB":["Very Small Business (VSB)"],"VSOE":["Vendor Specific Objective Evidence (VSOE)"],"WAM":["Web Asset Manager (WAM)"],"WCFO":["Worldwide Chief Finance Organization (WCFO)"],"WWSS":["Worldwide Sales and Services (WWSS)"],"XD":["Experience Design (XD)"],"YTD":["Year-to-Date (YTD)"],"CAD":["Computer Aided Drafting (CAD)"],"CAM":["Computer Aided Drafting (CAM)"],"AD":["Autodesk"],"UX":["User Experience"],"UI":["User Interface"],"GUI":["Graphical User Interface (GUI)"],"API":["Application Program Interface"],"TUX":["Total User Experience"],"TN":["TruNest"],"TLVS":["TruLaser View Studio"],"MSI":["Magestic Systems Incorporated"],"TAD":["The Autodesk Dictionary (TAD)"],"UPI":["Unique Product Identifier"],"FOMT":["Future of Making Things"],"IOT":["Internet of Things"],"PM":["Project Manager"],"SFO":["San Fransico Office"],"IA":["Information Architecture"],"FIFA":["Federation Interantionale de Football Association"],"TLV":["TruLaser View"],"DAP":["Data Analytics Platform (DAP)"],"MTBF":["Mean Time Between Failure"],"AKP":["Autodesk Knowledge Platform (AKP)"],"LUMA":["Looking Understanding Making Awesome (LUMA)"],"KPI":["Key Performance Indicator"],"RAAS":["Rendering as a Service (RaaS)"],"OSS":["Object Storage Service (OSS)"],"ACM":["Access Control Management (ACM)"],"MVP":["Minimal Viable Product"]}');